# Iron City IT - Atomic Red Team Test Schedule
# Weekly detection validation tests

schedule:
  frequency: weekly
  day: sunday
  time: "03:00"
  timezone: UTC

# Linux-compatible techniques for GitHub runners
linux_tests:
  - T1059.004  # Unix Shell
  - T1053.003  # Cron
  - T1548.001  # Setuid/Setgid
  - T1087.001  # Local Account Discovery
  - T1018      # Remote System Discovery
  - T1083      # File and Directory Discovery
  - T1057      # Process Discovery
  - T1082      # System Information Discovery
  - T1033      # System Owner/User Discovery
  - T1049      # System Network Connections

# Windows techniques (self-hosted runner required)
windows_tests:
  - T1059.001  # PowerShell
  - T1059.003  # Windows Command Shell
  - T1053.005  # Scheduled Task
  - T1547.001  # Registry Run Keys
  - T1003.001  # LSASS Memory
  - T1087.001  # Local Account Discovery
  - T1087.002  # Domain Account Discovery
  - T1069.001  # Local Groups
  - T1069.002  # Domain Groups
  - T1018      # Remote System Discovery

# Notification settings
notifications:
  slack_webhook: ${SLACK_WEBHOOK_URL}
  email: security@ironcityit.com

# Detection validation
expected_detections:
  T1059.001:
    - "PowerShell execution"
    - "Suspicious PowerShell command"
  T1059.004:
    - "Shell command execution"
    - "Suspicious shell activity"
